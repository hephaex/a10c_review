* 51주차 [10차 ARM-C] 51주차(2014.04.19) 후기
10차 ARM 리눅스 커널 스터디 51주차(2014.04.19) 후기입니다. 

# 일시 : 2014.04.19 (51주차)
# 모임명 : NAVER개발자커뮤니티지원_IAMROOT.ORG_10차ARM-C
# 장소 : 토즈 타워점
# 장소지원 : NAVER 개발자 커뮤니티 지원 프로그램
# 참여인원 :  4명
# 스터디 진도 : 
 - 지난 스터디에 이어서 mem_init()을 계속 분석합니다.
 - start_kernel()-> mm_init()->mem_init()->free_highpages();

# CONFIG_SA1111 // not defined

# free_highpages();
- max_low = max_low_pfn + PHYS_PFN_OFFSET;
 - max_low_pfn : 0x2f800 
 - PHYS_PFN_OFFSET : 0x20000
 - max_low : 0x4f800
- for_each_memblock(memory, mem) {
 - #define for_each_memblock(memblock_type, region)					\
	for (region = memblock.memblock_type.regions;				\
	     region < (memblock.memblock_type.regions + memblock.memblock_type.cnt);	\
	     region++)
 - for ( mem = memblock.memory.regions;				\
	     mem < (memblock.memory.regions + memblock.memory.cnt);	\
	     mem++)
   - memblock.memory.regions
   - struct memblock {
	phys_addr_t current_limit;
	struct memblock_type memory;
	struct memblock_type reserved; 
     };
   - memblock.memroy.regions[0].base : 0x2000 0000
   - memblock.memroy.regions[0].size : 0x8000 0000
- start : memblock_region_memory_base_pfn(mem) : 0x20000
- end   : memblock_region_memory_end_pfn(mem) : 0xa0000

- if (end <= max_low)
 - end : 0xa0000 <= max_low : 0x4f800
- if (start < max_low)
 - start : 0x20000 < max_low : 4f8000
 - srtat = max_low : 0x4f800

- for_each_memblock(reserved, res) {
 - for ( res = memblock.reserved.regions;				\
	     res < (memblock.reserved.regions + memblock.reserved.cnt);	\
	     res++)
 - res_start = memblock_region_reserved_base_pfn(res); 0x50000 (pfn)으로 가정
 - res_end   = memblock_region_reserved_end_pfn(res);  0x50100 (pfn)으로 가정

 - if (res_start != start)
  - res_start : 0x50000 , start : 0x4f800

- free_area_high()
 - pfn : 0x4f800, end : 0x50000 으로 가정
 - free_highmem_page(pfn_to_page(pfn));
 - order 0으로 buddy에 추가.

- mem_init_print_info()
 - .init.* 는 .data 섹션으로 바꿔 주는 과정이다. 
 - .rodata.* 는 .text나 .data섹션으로 바꿔준다. 

- vector : CONFIG_VECTORS_BASE : 0xffff0000 - PAGE_SIZE : 0x1000
 - 0xffff1000 - 0xffff0000 : 4 kB
 - UL(x) : xUL

- TASK_SIZE : 0xBF8000000 , MODULES_VADDR: 0xBF000000: 0xC0000000 (3GB) - 0x01000000 (16MB)

- BUILD_BUG_ON 
 - char[-1]이면 컴파일시 에러가 발생해서 개발자가 알수 있게 함.

- PKMAP_BASE + LAST_PKMAP * PAGE_SIZE > PAGE_OFFSET
 - // PAGE_OFFSET: 0xC0000000, PMD_SIZE: 0x00200000
 - // PKMAP_BASE : 0xBFE00000
 - // LAST_PKMAP : PTRS_PER_PTE : 512
 - // PAGE_SIZE  : 0x1000 (4kB)
- oif (PAGE_SIZE >= 16384 && get_num_physpages() <= 128) {
 - PAGE_SIZE : 4096 , 16k이상 이면 NG, 
 - physical : 512k 
 
- Slab, slub, slob 은 KERNEL의 CONFIG으로 설정

68317b1..a07195b  master     -> origin/master
Updating 68317b1..a07195b
Fast-forward
 arch/arm/include/asm/bitops.h         |   2 +
 arch/arm/include/asm/cache.h          |   5 ++
 arch/arm/include/asm/highmem.h        |   3 +
 arch/arm/include/asm/memory.h         |   4 +
 arch/arm/include/asm/page.h           |   1 +
 arch/arm/include/asm/pgtable-2level.h |   1 +
 arch/arm/include/asm/spinlock_types.h |   2 +
 arch/arm/mm/init.c                    |  52 +++++++++++--
 include/asm-generic/atomic-long.h     |   1 +
 include/asm-generic/bug.h             |   1 +
 include/asm-generic/getorder.h        |   6 ++
 include/linux/bug.h                   |   1 +
 include/linux/cache.h                 |   4 +-
 include/linux/gfp.h                   |   1 +
 include/linux/log2.h                  |   2 +
 include/linux/memblock.h              |   9 +++
 include/linux/mm.h                    |  14 +++-
 include/linux/mmzone.h                |   2 +
 include/linux/nodemask.h              |   1 +
 include/linux/page-flags.h            |   1 +
 include/linux/pfn.h                   |   2 +
 include/linux/slab.h                  |   8 +-
 include/linux/slub_def.h              |   2 +
 include/linux/spinlock_types.h        |   6 +-
 include/linux/types.h                 |   4 +
 include/uapi/linux/const.h            |   2 +
 include/uapi/linux/mman.h             |   1 +
 init/main.c                           |   5 ++
 mm/highmem.c                          |   4 +-
 mm/page_alloc.c                       |  20 ++++-
 mm/slab.h                             |  10 ++-
 mm/slab_common.c                      |  24 +++++-
 mm/slub.c                             | 171 ++++++++++++++++++++++++++++++++++++++++---
 33 files changed, 344 insertions(+), 28 deletions(-)
